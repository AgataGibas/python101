

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>10. Gra w Kółko i Krzyżyk (str) &mdash; Python 101 0.5 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
        <link rel="copyright" title="Copyright" href="../copyright.html"/>
    <link rel="top" title="Python 101 0.5 documentation" href="../index.html"/>
        <link rel="next" title="11. Gra w Kółko i Krzyżyk (obj)" href="../tictactoe/index.html"/>
        <link rel="prev" title="9. Gra w Ponga (obj)" href="../pong/index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> Python 101</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../env.html">Środowisko systemowe i wymagane oprogramowanie</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../env.html#szkolny-remix-ucznia-sru">Szkolny Remix Ucznia (SRU)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env.html#srodowisko-windows">Środowisko Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env.html#srodowisko-programistyczne-geany">Środowisko programistyczne Geany</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env.html#srodowisko-programistyczne-pycharm">Środowisko programistyczne PyCharm</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../git.html">Przygotowanie katalogu projektu</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../git.html#pobieranie-materialow">Pobieranie materiałów</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git.html#korzystanie-z-kodu-zrodlowego-w-opisie-przykladow">Korzystanie z kodu źródłowego w opisie przykładów</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git.html#synchronizacja-kodu-pomiedzy-etapami-przykladow">Synchronizacja kodu pomiędzy etapami przykładów</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../basic/basic.html">1. Python - Podstawy programowania</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic.html#zrodla">1.1. Źródła</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic.html#zmienne">1.2. Zmienne</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic.html#wyrazenia-warunkowe">1.3. Wyrażenia warunkowe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic.html#gra-w-zgadnij-liczbe">1.4. Gra w &#8220;zgadnij liczbę&#8221;</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic.html#zadania-dodatkowe">1.5. Zadania dodatkowe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic.html#petla-while">1.6. Pętla WHILE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic.html#wyrazenia-break-i-continue">1.7. Wyrażenia break i continue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic.html#petla-for">1.8. Pętla FOR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic.html#slowniczek">1.9. Słowniczek</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/basic1.html">2. Python w przykładach</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic1.html#jestem-python">2.1. Jestem Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic1.html#przywitaj-sie">2.2. Przywitaj się</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/basic2.html">3. Warunki i pętle</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic2.html#trzy-liczby">3.1. Trzy liczby</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic2.html#wydrukuj-alfabet">3.2. Wydrukuj alfabet</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/basic3.html">4. Listy, tuple i funkcje</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic3.html#pobierz-n-liczb">4.1. Pobierz <em>n</em> liczb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic3.html#ciag-fibonacciego">4.2. Ciąg Fibonacciego</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/basic4.html">5. Zbiory i słowniki</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic4.html#oceny-z-przedmiotow">5.1. Oceny z przedmiotów</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic4.html#slownik-slowek">5.2. Słownik słówek</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/basic5.html">6. Znam Pythona?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic5.html#trojkat">6.1. Trójkąt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic5.html#szyfr-cezara">6.2. Szyfr Cezara</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/basic6.html">7. Nie znam Pythona... jeszcze</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic6.html#wyrazenia-listowe">7.1. Wyrażenia listowe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic6.html#pliki">7.2. Pliki</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/basic6.html#materialy-w-sieci">7.3. Materiały w sieci</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pong_str/index.html">8. Gra w Ponga (str)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../pong_str/index.html#zmienne-i-plansza-gry">8.1. Zmienne i plansza gry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pong_str/index.html#obiekty-graficzne">8.2. Obiekty graficzne</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pong_str/index.html#wyswietlanie-tekstu">8.3. Wyświetlanie tekstu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pong_str/index.html#glowna-petla-programu">8.4. Główna pętla programu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pong_str/index.html#pocwicz-sam">8.5. Poćwicz sam</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pong/index.html">9. Gra w Ponga (obj)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../pong/index.html#przygotowanie">9.1. Przygotowanie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pong/index.html#okienko-gry">9.2. Okienko gry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pong/index.html#pileczka">9.3. Piłeczka</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pong/index.html#odbijanie-pileczki">9.4. Odbijanie piłeczki</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pong/index.html#odbijamy-pileczke-rakietka">9.5. Odbijamy piłeczkę rakietką</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pong/index.html#gramy-przeciwko-komputerowi">9.6. Gramy przeciwko komputerowi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pong/index.html#pokazujemy-punkty">9.7. Pokazujemy punkty</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pong/index.html#zadania-dodatkowe-i-rzeczy-ktore-mozna-poprawic">9.8. Zadania dodatkowe i rzeczy które można poprawić</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pong/index.html#slowniczek">9.9. Słowniczek</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">10. Gra w Kółko i Krzyżyk (str)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#zmienne-i-plansza-gry">10.1. Zmienne i plansza gry</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rysuj-plansze-gry">10.2. Rysuj planszę gry</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sztuczna-inteligencja">10.3. Sztuczna inteligencja</a></li>
<li class="toctree-l2"><a class="reference internal" href="#glowna-petla-programu">10.4. Główna pętla programu</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pocwicz-sam">10.5. Poćwicz sam</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tictactoe/index.html">11. Gra w Kółko i Krzyżyk (obj)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tictactoe/index.html#przygotowanie">11.1. Przygotowanie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tictactoe/index.html#okienko-gry">11.2. Okienko gry</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../life_str/index.html">12. Gra w życie Conwaya (str)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../life_str/index.html#zmienne-i-plansza-gry">12.1. Zmienne i plansza gry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../life_str/index.html#populacja-komorek">12.2. Populacja komórek</a></li>
<li class="toctree-l2"><a class="reference internal" href="../life_str/index.html#glowna-petla-programu">12.3. Główna pętla programu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../life_str/index.html#pocwicz-sam">12.4. Poćwicz sam</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../life/index.html">13. Gra w życie Conwaya (obj)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../life/index.html#przygotowanie">13.1. Przygotowanie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../life/index.html#okienko-gry">13.2. Okienko gry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../life/index.html#tworzymy-matryce-zycia">13.3. Tworzymy matrycę życia</a></li>
<li class="toctree-l2"><a class="reference internal" href="../life/index.html#ukladamy-zywe-komorki-na-planszy">13.4. Układamy żywe komórki na planszy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../life/index.html#dodajemy-populacje-do-kontrolera-gry">13.5. Dodajemy populację do kontrolera gry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../life/index.html#szukamy-zyjacych-sasiadow">13.6. Szukamy żyjących sąsiadów</a></li>
<li class="toctree-l2"><a class="reference internal" href="../life/index.html#zadania-dodatkowe-i-rzeczy-ktore-mozna-poprawic">13.7. Zadania dodatkowe i rzeczy które można poprawić</a></li>
<li class="toctree-l2"><a class="reference internal" href="../life/index.html#slowniczek">13.8. Słowniczek</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bazy/index1.html">14. Bazy danych w Pythonie</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../bazy/index1.html#sql">14.1. SQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bazy/index1.html#systemy-orm">14.2. Systemy ORM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../quiz/index.html">15. Quiz – aplikacja internetowa</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quiz/index.html#struktura-katalogow">15.1. Struktura katalogów</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quiz/index.html#szkielet-aplikacji">15.2. Szkielet aplikacji</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quiz/index.html#definiowanie-widokow-strona-glowna">15.3. Definiowanie widoków – strona główna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quiz/index.html#pokaz-dane-aplikacji-pytania-i-odpowiedzi">15.4. Pokaż dane aplikacji – pytania i odpowiedzi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quiz/index.html#oceniamy-odpowiedzi">15.5. Oceniamy odpowiedzi</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../todo/index.html">16. ToDo – aplikacja internetowa</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../todo/index.html#katalog-plik-i-przeznaczenie-aplikacji">16.1. Katalog, plik i przeznaczenie aplikacji</a></li>
<li class="toctree-l2"><a class="reference internal" href="../todo/index.html#szkielet-aplikacji">16.2. Szkielet aplikacji</a></li>
<li class="toctree-l2"><a class="reference internal" href="../todo/index.html#definiowanie-widokow">16.3. Definiowanie widoków</a></li>
<li class="toctree-l2"><a class="reference internal" href="../todo/index.html#model-bazy-danych">16.4. Model bazy danych</a></li>
<li class="toctree-l2"><a class="reference internal" href="../todo/index.html#polaczenie-z-baza-danych">16.5. Połączenie z bazą danych</a></li>
<li class="toctree-l2"><a class="reference internal" href="../todo/index.html#pobieranie-i-wyswietlanie-danych">16.6. Pobieranie i wyświetlanie danych</a></li>
<li class="toctree-l2"><a class="reference internal" href="../todo/index.html#formularz-dodawania-zadan">16.7. Formularz dodawania zadań</a></li>
<li class="toctree-l2"><a class="reference internal" href="../todo/index.html#wyglad-aplikacji-opcja">16.8. Wygląd aplikacji (opcja)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../todo/index.html#oznaczanie-zadan-jako-wykonane-opcja">16.9. Oznaczanie zadań jako wykonane (opcja)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../todo/index.html#pocwicz-sam">16.10. POĆWICZ SAM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chatter/index.html">17. Chatter – aplikacja internetowa</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chatter/index.html#projekt-i-aplikacja">17.1. Projekt i aplikacja</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatter/index.html#model-widok-kontroler">17.2. Model – Widok – Kontroler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatter/index.html#model-danych-i-baza">17.3. Model danych i baza</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatter/index.html#panel-administracyjny">17.4. Panel administracyjny</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatter/index.html#strona-glowna-widoki-i-szablony">17.5. Strona główna – widoki i szablony</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatter/index.html#logowanie-uzytkownikow">17.6. Logowanie użytkowników</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatter/index.html#dodawanie-i-wyswietlanie-wiadomosci">17.7. Dodawanie i wyświetlanie wiadomości</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatter/index.html#rejestrowanie-uzytkownikow">17.8. Rejestrowanie użytkowników</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatter/index.html#wylogowywanie-uzytkownikow">17.9. Wylogowywanie użytkowników</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatter/index.html#pocwicz-sam">17.10. POĆWICZ SAM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">18. FAQ</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Python 101</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>10. Gra w Kółko i Krzyżyk (str)</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/tictactoe_str/index.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="gra-w-kolko-i-krzyzyk-str">
<h1>10. Gra w Kółko i Krzyżyk (str)<a class="headerlink" href="#gra-w-kolko-i-krzyzyk-str" title="Permalink to this headline">¶</a></h1>
<p>Klasyczna gra w kółko i krzyżyk zrealizowana przy pomocy  <a class="reference external" href="http://www.pygame.org/wiki/tutorials">PyGame</a>. Wersja strukturalna.
Biblioteka <a class="reference external" href="http://www.pygame.org/wiki/tutorials">PyGame</a> ułatwia tworzenie aplikacji multimedialnych, w tym gier.</p>
<div class="figure">
<img alt="../_images/tictactoe.png" src="../_images/tictactoe.png" />
</div>
<div class="section" id="zmienne-i-plansza-gry">
<h2>10.1. Zmienne i plansza gry<a class="headerlink" href="#zmienne-i-plansza-gry" title="Permalink to this headline">¶</a></h2>
<p>Tworzymy plik <code class="docutils literal"><span class="pre">tictactoe.py</span></code> w terminalu lub w wybranym edytorze i zaczynamy od zdefiniowania zmiennych określających właściwości obiektów w naszej grze.</p>
<div class="code_no">Kod nr <script>var code_no = code_no || 1; document.write(code_no++);</script></div><div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#! /usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">pygame</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">pygame.locals</span> <span class="kn">import</span> <span class="o">*</span> <span class="c">#udostępnienie nazw metod z locals</span>

<span class="c"># inicjacja modułu pygame</span>
<span class="n">pygame</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

<span class="c"># przygotowanie powierzchni do rysowania, czyli inicjacja okna gry</span>
<span class="n">OKNOGRY</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_mode</span><span class="p">((</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="c"># tytuł okna gry</span>
<span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s">&#39;Kółko i krzyżyk&#39;</span><span class="p">)</span>

<span class="c"># lista opisująca stan pola gry, 0 - pole puste, 1 - gracz, 2 - komputer</span>
<span class="n">POLE_GRY</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="n">RUCH</span> <span class="o">=</span> <span class="mi">1</span> <span class="c"># do kogo należy ruch: 1 – gracz, 2 – komputer</span>
<span class="n">WYGRANY</span> <span class="o">=</span> <span class="mi">0</span> <span class="c"># wynik gry: 0 - nikt, 1 - gracz, 2 - komputer, 3 - remis</span>
<span class="n">WYGRANA</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</td></tr></table></div>
<p>W instrukcji <code class="docutils literal"><span class="pre">pygame.display.set_mode()</span></code> inicjalizujemy okno gry o rozmiarach 150x150 pikseli i 32 bitowej głębi kolorów. Tworzymy w ten sposób powierzchnię główną do rysowania zapisaną w zmiennej <code class="docutils literal"><span class="pre">OKNOGRY</span></code>. <code class="docutils literal"><span class="pre">POLE_GRY</span></code> to lista elementów reprezentujących pola planszy, które mogą być puste (wartość 0), zawierać kółka gracza (wartość 1) lub komputera (wartość 2). Pozostałe zmienne określają, do kogo należy następny ruch, kto wygrał i czy nastąpił koniec gry.</p>
</div>
<div class="section" id="rysuj-plansze-gry">
<h2>10.2. Rysuj planszę gry<a class="headerlink" href="#rysuj-plansze-gry" title="Permalink to this headline">¶</a></h2>
<p>Planszę można narysować na wiele sposobów, np. tak:</p>
<div class="code_no">Kod nr <script>var code_no = code_no || 1; document.write(code_no++);</script></div><div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># rysowanie planszy gry, czyli linii oddzielających pola</span>
<span class="k">def</span> <span class="nf">rysuj_plansze</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="c">#x</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span><span class="c">#y</span>
            <span class="c"># argumenty: powierzchnia, kolor, x,y, w,h, grubość linii</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">OKNOGRY</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="n">Rect</span><span class="p">((</span><span class="n">j</span><span class="o">*</span><span class="mi">50</span><span class="p">,</span><span class="n">i</span><span class="o">*</span><span class="mi">50</span><span class="p">),(</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>

<span class="c"># narysuj kółka</span>
<span class="k">def</span> <span class="nf">rysuj_pole_gry</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">pole</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="n">j</span> <span class="c">#zmienna pole przyjmuje wartości od 0-8</span>
            <span class="c"># x i y określają środki kolejnych pól,</span>
            <span class="c"># a więc wartości: 25,25, 25,75 25,125 75,25 itd.</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">j</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span><span class="mi">25</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span><span class="mi">25</span>

            <span class="k">if</span> <span class="n">POLE_GRY</span><span class="p">[</span><span class="n">pole</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">OKNOGRY</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span><span class="c">#rysuj kółko gracza</span>
            <span class="k">elif</span> <span class="n">POLE_GRY</span><span class="p">[</span><span class="n">pole</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">pygame</span><span class="o">.</span><span class="n">draw</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">OKNOGRY</span><span class="p">,(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span><span class="c">#rysuj kółko komputera</span>
</pre></div>
</td></tr></table></div>
<p>Pierwsza funkcja, <code class="docutils literal"><span class="pre">rysuj_plansze()</span></code>, wykorzystując zagnieżdżone pętle, rysuje nam 9 kwadratów o białym obramowaniu i szerokości 50 pikseli (formalnie są to obiekty <a class="reference internal" href="#term-rect"><em class="xref std std-term">Rect</em></a> zwracane przez metodę <code class="docutils literal"><span class="pre">pygame.draw.rect()</span></code>). Zadaniem funkcji <code class="docutils literal"><span class="pre">rysuj_pole_gry()</span></code> jest narysowanie w zależności od stanu planszy gry zapisanego w liście <code class="docutils literal"><span class="pre">POLE_GRY</span></code> kółek o niebieskim (gracz) lub czerwonym (komputer) kolorze za pomocą metody <code class="docutils literal"><span class="pre">pygame.draw.circle()</span></code>.</p>
</div>
<div class="section" id="sztuczna-inteligencja">
<h2>10.3. Sztuczna inteligencja<a class="headerlink" href="#sztuczna-inteligencja" title="Permalink to this headline">¶</a></h2>
<p>Decydującą rolę w grze odgrywa komputer, od którego inteligencji zależy, czy rozgrywka przyniesie jakąś satysfakcję. Dopisujemy więc funkcje obsługujące sztuczną inteligencję:</p>
<div class="code_no">Kod nr <script>var code_no = code_no || 1; document.write(code_no++);</script></div><div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># postaw kółko lub krzyżyk (w tej wersji też kółko, ale w innym kolorze :-))</span>
<span class="k">def</span> <span class="nf">postaw_znak</span><span class="p">(</span><span class="n">pole</span><span class="p">,</span> <span class="n">RUCH</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">POLE_GRY</span><span class="p">[</span><span class="n">pole</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">RUCH</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c"># ruch gracza</span>
            <span class="n">POLE_GRY</span><span class="p">[</span><span class="n">pole</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">RUCH</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="c"># ruch komputera</span>
            <span class="n">POLE_GRY</span><span class="p">[</span><span class="n">pole</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">return</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">RUCH</span>

<span class="c"># funkcja pomocnicza sprawdzająca, czy komputer może wygrać, czy powinien</span>
<span class="c"># blokować gracza, czy może wygrał komputer lub gracz</span>
<span class="k">def</span> <span class="nf">sprawdz_pola</span><span class="p">(</span><span class="n">uklad</span><span class="p">,</span> <span class="n">wygrany</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="n">wartosc</span> <span class="o">=</span> <span class="bp">None</span><span class="p">;</span>
    <span class="c"># lista wielowymiarowa, której elementami są inne listy zagnieżdżone</span>
    <span class="n">POLA_INDEKSY</span> <span class="o">=</span> <span class="p">[</span> <span class="c"># trójki pól planszy do sprawdzania</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="c"># indeksy pól w poziomie (wiersze)</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="c"># indeksy pól w pionie (kolumny)</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="c"># indeksy pól na skos (przekątne)</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">lista</span> <span class="ow">in</span> <span class="n">POLA_INDEKSY</span><span class="p">:</span>
        <span class="n">kol</span> <span class="o">=</span> <span class="p">[]</span> <span class="c"># lista pomocnicza</span>
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">lista</span><span class="p">:</span>
            <span class="n">kol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">POLE_GRY</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="c"># zapisz wartość odczytaną z POLE_GRY</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">kol</span> <span class="ow">in</span> <span class="n">uklad</span><span class="p">):</span> <span class="c"># jeżeli znalazłeś układ wygrywający lub blokujący</span>
            <span class="c"># zwróć wygranego (1,2) lub indeks pola do zaznaczenia</span>
            <span class="n">wartosc</span> <span class="o">=</span> <span class="n">wygrany</span> <span class="k">if</span> <span class="n">wygrany</span> <span class="k">else</span> <span class="n">lista</span><span class="p">[</span><span class="n">kol</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">wartosc</span>

<span class="c"># ruchy komputera</span>
<span class="k">def</span> <span class="nf">ai_ruch</span><span class="p">(</span><span class="n">RUCH</span><span class="p">):</span>
    <span class="n">pole</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># które pole powinien zaznaczyć komputer</span>

    <span class="c"># listy wielowymiarowe, których elementami są inne listy zagnieżdżone</span>
    <span class="n">uklady_wygrywam</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
    <span class="n">uklady_blokuje</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>

    <span class="c"># sprawdź, czy komputer może wygrać</span>
    <span class="n">pole</span> <span class="o">=</span> <span class="n">sprawdz_pola</span><span class="p">(</span><span class="n">uklady_wygrywam</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pole</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">postaw_znak</span><span class="p">(</span><span class="n">pole</span><span class="p">,</span> <span class="n">RUCH</span><span class="p">)</span>

    <span class="c"># jeżeli komputer nie może wygrać, blokuj gracza</span>
    <span class="n">pole</span> <span class="o">=</span> <span class="n">sprawdz_pola</span><span class="p">(</span><span class="n">uklady_blokuje</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pole</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">postaw_znak</span><span class="p">(</span><span class="n">pole</span><span class="p">,</span> <span class="n">RUCH</span><span class="p">)</span>

    <span class="c"># jeżeli nie można wygrać i gracza nie trzeba blokować, wylosuj pole</span>
    <span class="k">while</span> <span class="n">pole</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span> <span class="c">#wylosuj wartość od 0 do 8</span>
        <span class="k">if</span> <span class="n">POLE_GRY</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pole</span> <span class="o">=</span> <span class="n">pos</span>

    <span class="k">return</span> <span class="n">postaw_znak</span><span class="p">(</span><span class="n">pole</span><span class="p">,</span> <span class="n">RUCH</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Za sposób gry komputera odpowiada funkcja <code class="docutils literal"><span class="pre">ai_ruch()</span></code> (<em>ai</em> – ang. <em>artificial intelligence</em>, sztuczna inteligencja). Na początku zawiera ona definicje dwóch list (<code class="docutils literal"><span class="pre">uklady_wygrywam,</span> <span class="pre">uklady_blokuje</span></code>), zawierających układy wartości, dla których komputer wygrywa oraz które powinien zablokować, aby nie wygrał gracz. O tym, które pole należy zaznaczyć, decyduje funkcja <code class="docutils literal"><span class="pre">sprawdz_pola()</span></code> przyjmująca jako argument najpierw układy wygrywające, później blokujące.</p>
<p>Podstawą działania funkcji <code class="docutils literal"><span class="pre">sprawdz_pola()</span></code> jest lista <code class="docutils literal"><span class="pre">POLA_INDEKSY</span></code> zawierająca jako elementy listy indeksów pól tworzących wiersze, kolumny i przekątne <code class="docutils literal"><span class="pre">POLA_GRY</span></code> (czyli planszy). Pętla <code class="docutils literal"><span class="pre">for</span> <span class="pre">lista</span> <span class="pre">in</span> <span class="pre">POLA_INDEKSY:</span></code> pobiera kolejne listy, tworzy w liście pomocniczej kol trójkę wartości odczytanych z <code class="docutils literal"><span class="pre">POLA_GRY</span></code> i próbuje ją dopasować do przekazanego jako argument układu wygrywającego lub blokującego. Jeżeli znajdzie dopasowanie zwraca liczbę oznaczającą gracza lub komputer, o ile opcjonalny argument <code class="docutils literal"><span class="pre">WYGRANY</span></code> ma wartość inną niż <code class="docutils literal"><span class="pre">None</span></code>, w przeciwnym razie zwracany jest indeks <code class="docutils literal"><span class="pre">POLA_GRY</span></code>, na którym komputer powinien postawić swój znak.</p>
<p>Jeżeli indeks zwrócony przez funkcję <code class="docutils literal"><span class="pre">sprawdz_pola()</span></code> jest inny niż <code class="docutils literal"><span class="pre">None</span></code>, przekazywany jest do funkcji <code class="docutils literal"><span class="pre">postaw_znak()</span></code>, której zadaniem jest zapisanie w <code class="docutils literal"><span class="pre">POLU_GRY</span></code> pod otrzymanym indeksem wartości symbolizującej znak komputera (czyli 2) oraz nadanie i zwrócenie zmiennej RUCH wskazującej na gracza (wartość 1).</p>
<p>O ile na planszy nie ma układu wygrywającego lub nie ma konieczności blokowania gracza, komputer w pętli losuje przypadkowe pole (<code class="docutils literal"><span class="pre">random.randrange(0,9)</span></code>), dopóki nie znajdzie pustego, i przekazuje jego indeks do funkcji <code class="docutils literal"><span class="pre">postaw_znak()</span></code>.</p>
</div>
<div class="section" id="glowna-petla-programu">
<h2>10.4. Główna pętla programu<a class="headerlink" href="#glowna-petla-programu" title="Permalink to this headline">¶</a></h2>
<p>Programy interaktywne, w tym gry, reagujące na działania użytkownika, takie jak ruchy czy kliknięcia myszą, działają w pętli, której zadaniem jest:</p>
<ol class="arabic simple">
<li>przechwycenie i obsługa działań użytkownika, czyli tzw. zdarzeń (ruchy, kliknięcia myszą, naciśnięcie klawiszy),</li>
<li>aktualizacja stanu gry (przesunięcia elementów, aktualizacja planszy),</li>
<li>aktualizacja wyświetlanego okna (narysowanie nowego stanu gry).</li>
</ol>
<p>Dopisujemy więc do kodu główną pętlę wraz z obsługą zdarzeń oraz dwie funkcje pomocnicze w niej wywoływane:</p>
<div class="code_no">Kod nr <script>var code_no = code_no || 1; document.write(code_no++);</script></div><div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># sprawdź, kto wygrał, a może jest remis?</span>
<span class="k">def</span> <span class="nf">kto_wygral</span><span class="p">():</span>
    <span class="c"># układy wygrywające dla gracza i komputera</span>
    <span class="n">uklad_gracz</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">uklad_komp</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>

    <span class="n">WYGRANY</span> <span class="o">=</span> <span class="n">sprawdz_pola</span><span class="p">(</span><span class="n">uklad_gracz</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c"># czy wygrał gracz?</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">WYGRANY</span><span class="p">:</span> <span class="c"># jeżeli gracz nie wygrywa</span>
        <span class="n">WYGRANY</span> <span class="o">=</span> <span class="n">sprawdz_pola</span><span class="p">(</span><span class="n">uklad_komp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c"># czy wygrał komputer?</span>

    <span class="c"># sprawdź remis</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">POLE_GRY</span> <span class="ow">and</span> <span class="n">WYGRANY</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]:</span>
        <span class="n">WYGRANY</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">return</span> <span class="n">WYGRANY</span>

<span class="c"># funkcja wyświetlająca komunikat końcowy</span>
<span class="c"># tworzy nowy obrazek z tekstem, pobiera jego prostokątny obszar</span>
<span class="c"># pozycjonuje go i rysuje w oknie gry</span>
<span class="k">def</span> <span class="nf">drukuj_wynik</span><span class="p">(</span><span class="n">WYGRANY</span><span class="p">):</span>
    <span class="n">fontObj</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="s">&#39;freesansbold.ttf&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">WYGRANY</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">tekst</span> <span class="o">=</span> <span class="s">u&#39;Wygrał gracz!&#39;</span>
    <span class="k">elif</span> <span class="n">WYGRANY</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">tekst</span> <span class="o">=</span> <span class="s">u&#39;Wygrał komputer!&#39;</span>
    <span class="k">elif</span> <span class="n">WYGRANY</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">tekst</span> <span class="o">=</span> <span class="s">&#39;Remis!&#39;</span>
    <span class="n">tekst_obr</span> <span class="o">=</span> <span class="n">fontObj</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">tekst</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
    <span class="n">tekst_prost</span> <span class="o">=</span> <span class="n">tekst_obr</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
    <span class="n">tekst_prost</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="mi">75</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
    <span class="n">OKNOGRY</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="n">tekst_obr</span><span class="p">,</span> <span class="n">tekst_prost</span><span class="p">)</span>

<span class="c"># pętla główna programu</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="c"># obsługa zdarzeń generowanych przez gracza</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">pygame</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
        <span class="c"># przechwyć zamknięcie okna</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">QUIT</span><span class="p">:</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">WYGRANA</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">RUCH</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">MOUSEBUTTONDOWN</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c"># jeżeli naciśnięto pierwszy przycisk</span>
                        <span class="n">mouseX</span><span class="p">,</span> <span class="n">mouseY</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">pos</span> <span class="c"># rozpakowanie tupli</span>
                        <span class="n">pole</span> <span class="o">=</span> <span class="p">((</span><span class="n">mouseY</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">mouseX</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span> <span class="c"># wylicz indeks klikniętego pola</span>
                        <span class="n">RUCH</span> <span class="o">=</span> <span class="n">postaw_znak</span><span class="p">(</span><span class="n">pole</span><span class="p">,</span> <span class="n">RUCH</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">RUCH</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">RUCH</span> <span class="o">=</span> <span class="n">ai_ruch</span><span class="p">(</span><span class="n">RUCH</span><span class="p">)</span>

            <span class="n">WYGRANY</span> <span class="o">=</span> <span class="n">kto_wygral</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">WYGRANY</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">WYGRANA</span> <span class="o">=</span> <span class="bp">True</span>


    <span class="n">OKNOGRY</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="c"># definicja koloru powierzchni w RGB</span>
    <span class="n">rysuj_plansze</span><span class="p">()</span>
    <span class="n">rysuj_pole_gry</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">WYGRANA</span><span class="p">:</span>
        <span class="n">drukuj_wynik</span><span class="p">(</span><span class="n">WYGRANY</span><span class="p">)</span>
    <span class="n">pygame</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>W obrębie głównej pętli programu pętla <code class="docutils literal"><span class="pre">for</span></code> odczytuje kolejne zdarzenia zwracane przez metodę <code class="docutils literal"><span class="pre">pygame.event.get()</span></code>. Jak widać, w pierwszej kolejności obsługujemy wydarzenie typu (właściwość <code class="docutils literal"><span class="pre">.type</span></code>) QUIT, czyli zakończenie aplikacji. Później, o ile nikt nie wygrał (zmienna <code class="docutils literal"><span class="pre">WYGRANA</span></code> ma wartość <code class="docutils literal"><span class="pre">False</span></code>), a kolej na ruch gracza (zmienna <code class="docutils literal"><span class="pre">RUCH</span></code> ma wartość 1), przechwytujemy wydarzenie <code class="docutils literal"><span class="pre">MOUSEBUTTONDOWN</span></code>, tj. kliknięcie myszą. Sprawdzamy, czy naciśnięto pierwszy przycisk, pobieramy współrzędne kursora (<code class="docutils literal"><span class="pre">.pos</span></code>) i wyliczamy indeks klikniętego pola. Na koniec wywołujemy omówioną wcześniej <code class="docutils literal"><span class="pre">funkcję</span> <span class="pre">postaw_znak()</span></code>. Jeżeli kolej na komputer, uruchamiamy sztuczną inteligencję (<code class="docutils literal"><span class="pre">ai_ruch()</span></code>).</p>
<p>Po wykonaniu ruchu przez komputer lub gracza trzeba sprawdzić, czy któryś z przeciwników nie wygrał. Korzystamy z funkcji <code class="docutils literal"><span class="pre">kto_wygral()</span></code>, która definiuje dwa układy wygrywające (<code class="docutils literal"><span class="pre">uklad_gracz</span></code> i <code class="docutils literal"><span class="pre">uklad_komputer</span></code>) i za pomocą omówionej wcześniej funkcji <code class="docutils literal"><span class="pre">sprawdz_pola()</span></code> sprawdza, czy można je odnaleźć w <code class="docutils literal"><span class="pre">POLU_GRY</span></code>. Na końcu sprawdza możliwość remisu i zwraca wartość symbolizującą wygranego (1, 2, 3) lub <code class="docutils literal"><span class="pre">None</span></code>, o ile możliwe są kolejne ruchy. Wartość ta wpływa w pętli głównej na zmienną <code class="docutils literal"><span class="pre">WYGRANA</span></code> kontrolującą obsługę ruchów gracza i komputera.</p>
<p>Funkcja <code class="docutils literal"><span class="pre">drukuj_wynik()</span></code> ma za zadanie przygotowanie końcowego napisu. W tym celu tworzy obiekt czcionki z podanego pliku (<code class="docutils literal"><span class="pre">pygame.font.Font()</span></code>), następnie renderuje nowy obrazek z odpowiednim tekstem (<code class="docutils literal"><span class="pre">.render()</span></code>), pobiera jego powierzchnię prostokątną (<code class="docutils literal"><span class="pre">.get_rect()</span></code>), pozycjonują ją (<code class="docutils literal"><span class="pre">.center()</span></code>) i rysują na głównej powierzchni gry (<code class="docutils literal"><span class="pre">.blit()</span></code>).
Ostatnie linie kodu wypełniają okno gry kolorem (<code class="docutils literal"><span class="pre">.fill()</span></code>), wywołują funkcję rysujące planszę (<code class="docutils literal"><span class="pre">rysuj_plansze()</span></code>), stan gry (<code class="docutils literal"><span class="pre">rysuj_pole_gry()</span></code>, czyli znaki gracza i komputera), a także ewentualny komunikat końcowy (<code class="docutils literal"><span class="pre">drukuj_wynik()</span></code>). Funkcja <code class="docutils literal"><span class="pre">pygame.display.update()</span></code>, która musi być wykonywana na końcu rysowania, aktualizuje obraz gry na ekranie.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Plik wykorzystywany do wyświetlania tekstu (<code class="docutils literal"><span class="pre">freesansbold.ttf</span></code>) musi znaleźć się w katalogu ze skryptem.</p>
</div>
<p>Grę możemy uruchomić poleceniem wpisanym w terminalu:</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ python tictactoe.py
</pre></div>
</div>
</div>
<div class="section" id="pocwicz-sam">
<h2>10.5. Poćwicz sam<a class="headerlink" href="#pocwicz-sam" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Zmień grę tak, aby zaczynał ją komputer.
Dodaj do gry możliwość rozgrywki wielokrotnej bez konieczności ponownego uruchamiania skryptu.
Zmodyfikuj funkcję rysującą pole gry tak, aby komputer rysował krzyżyki, a nie kółka.</div></blockquote>
<div class="section" id="zrodla">
<h3>10.5.1. Źródła<a class="headerlink" href="#zrodla" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference download internal" href="../_downloads/tictactoe_str.zip"><code class="xref download docutils literal"><span class="pre">tictactoe_str.zip</span></code></a></li>
<li><a class="reference download internal" href="../_downloads/tictactoe_str.pdf"><code class="xref download docutils literal"><span class="pre">tictactoe_str.pdf</span></code></a></li>
</ul>
<p>Kolejne wersje tworzenego kodu można pobierać wydając polecenia:</p>
<div class="highlight-bash"><div class="highlight"><pre>~/python101<span class="nv">$ </span>git checkout -f tic/str1
~/python101<span class="nv">$ </span>git checkout -f tic/str2
~/python101<span class="nv">$ </span>git checkout -f tic/str3
~/python101<span class="nv">$ </span>git checkout -f tic/str4
</pre></div>
</div>
<p>Uruchamiamy je wydając polecenie:</p>
<div class="highlight-bash"><div class="highlight"><pre>~/python101<span class="nv">$ </span><span class="nb">cd </span>docs/tictactoe_str
~/python101/docs/tictactoe_str<span class="nv">$ </span>python tictactoe_strx.py
</pre></div>
</div>
<p>- gdzie <em>x</em> jest numerem kolejnej wersji kodu.</p>
</div>
<div class="section" id="slownik">
<h3>10.5.2. Słownik<a class="headerlink" href="#slownik" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-klatki-na-sekunde-fps">Klatki na sekundę (FPS)</dt>
<dd>liczba klatek wyświetlanych w ciągu sekundy, czyli częstotliwość, z jaką statyczne obrazy pojawiają się na ekranie. Jest ona miarą płynności wyświetlania ruchomych obrazów.</dd>
<dt id="term-kanal-alfa-ang-alpha-channel">Kanał alfa (ang. alpha channel)</dt>
<dd>w grafice komputerowej jest kanałem, który definiuje przezroczyste obszary grafiki. Jest on zapisywany dodatkowo wewnątrz grafiki razem z trzema wartościami barw składowych RGB.</dd>
<dt id="term-inicjalizacja">Inicjalizacja</dt>
<dd>proces wstępnego przypisania wartości zmiennym i obiektom. Każdy obiekt jest inicjalizowany różnymi sposobami zależnie od swojego typu.</dd>
<dt id="term-iteracja">Iteracja</dt>
<dd>czynność powtarzania (najczęściej wielokrotnego) tej samej instrukcji (albo wielu instrukcji) w pętli. Mianem iteracji określa się także operacje wykonywane wewnątrz takiej pętli.</dd>
<dt id="term-zdarzenie-ang-event">Zdarzenie (ang. event)</dt>
<dd>zapis zajścia w systemie komputerowym określonej sytuacji, np. poruszenie myszką, kliknięcie, naciśnięcie klawisza.</dd>
<dt id="term-pygame-locals">pygame.locals</dt>
<dd>moduła zawierający różne stałe używane przez Pygame, np. typy zdarzeń, identyfikatory naciśniętych klawiszy itp.</dd>
<dt id="term-pygame-time-clock">pygame.time.Clock()</dt>
<dd>tworzy obiekt do śledzenia czasu; <code class="docutils literal"><span class="pre">.tick()</span></code> – kontroluje ile milisekund upłynęło od poprzedniego wywołania.</dd>
<dt id="term-pygame-display-set-mode">pygame.display.set_mode()</dt>
<dd>inicjuje okno lub ekran do wyświetlania, parametry: rozdzielczość w pikselach = (x,y), flagi, głębia koloru.</dd>
<dt id="term-pygame-display-set-caption">pygame.display.set_caption()</dt>
<dd>ustawia tytuł okna, parametr: tekst tytułu.</dd>
<dt id="term-pygame-surface">pygame.Surface()</dt>
<dd>obiekt reprezentujący dowolny obrazek (grafikę), który ma określoną rozdzielczość (szerokość i wysokość) oraz format pikseli (głębokość, przezroczystość); SRCALPHA – oznacza, że format pikseli będzie zawierać ustawienie alfa (przezroczystości); <code class="docutils literal"><span class="pre">.fill()</span></code> – wypełnia obrazek kolorem; <code class="docutils literal"><span class="pre">.get_rect()</span></code> – zwraca prostokąt zawierający obrazek, czyli obiekt <strong>Rect</strong>; <code class="docutils literal"><span class="pre">.convert_alpha()</span></code> – zmienia format pikseli, w tym przezroczystość; <code class="docutils literal"><span class="pre">.blit()</span></code> – rysuje jeden obrazek na drugim, parametry: źródło, cel.</dd>
<dt id="term-pygame-draw-ellipse">pygame.draw.ellipse()</dt>
<dd>rysuje okrągły kształt wewnątrz prostokąta, parametry: przestrzeń, kolor, prostokąt.</dd>
<dt id="term-pygame-draw-rect">pygame.draw.rect()</dt>
<dd>rysuje prostokąt na wskazanej powierzchni, parametry: powierzchnia, kolor, obiekt Rect, grubość obramowania.</dd>
<dt id="term-pygame-font-font">pygame.font.Font()</dt>
<dd>tworzy obiekt czcionki z podanego pliku; <code class="docutils literal"><span class="pre">.render()</span></code> – tworzy nową powierzchnię z podanym tekstem, parametry: tekst, antyalias, kolor, tło.</dd>
<dt id="term-pygame-event-get">pygame.event.get()</dt>
<dd>pobiera zdarzenia z kolejki zdarzeń; <code class="docutils literal"><span class="pre">event.type()</span></code> – zwraca identyfikator SDL typu zdarzenia, np. KEYDOWN, KEYUP, MOUSEMOTION, MOUSEBUTTONDOWN, QUIT.</dd>
<dt id="term-sdl-simple-directmedia-layer">SDL (Simple DirectMedia Layer)</dt>
<dd>międzyplatformowa biblioteka ułatwiająca tworzenie gier i programów multimedialnych.</dd>
<dt id="term-rect">Rect</dt>
<dd>obiekt pygame.Rect przechowujący współrzędne prostokąta; <code class="docutils literal"><span class="pre">.centerx,</span> <span class="pre">.x,</span> <span class="pre">.y,</span> <span class="pre">.top,</span> <span class="pre">.bottom,</span> <span class="pre">.left,</span> <span class="pre">.right</span></code> – wirtualne własności obiektu prostokąta określające jego położenie; <code class="docutils literal"><span class="pre">.colliderect()</span></code> – metoda sprawdza czy dwa prostokąty nachodzą na siebie.</dd>
</dl>
</div>
<div class="section" id="metryka">
<h3>10.5.3. Metryka<a class="headerlink" href="#metryka" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Autorzy:</th><td class="field-body">Robert Bednarz &lt;<a class="reference external" href="mailto:ecg&#37;&#52;&#48;ecg&#46;vot&#46;pl">ecg<span>&#64;</span>ecg<span>&#46;</span>vot<span>&#46;</span>pl</a>&gt;, Łukasz Zarzecki</td>
</tr>
<tr class="field-even field"><th class="field-name">Utworzony:</th><td class="field-body">2014-12-11 o 15:19</td>
</tr>
</tbody>
</table>
<style>
    div.code_no { text-align: right; background: #e3e3e3; padding: 6px 12px; }
    div.highlight, div.highlight-python { margin-top: 0px; }
</style><p>
    <a style="float:left; margin: 0.3em 1em 1em 0" rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
        <img alt="Licencja Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>
    Materiały <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">Python 101</span>
    udostępniane przez <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.ceo.org.pl/" property="cc:attributionName" rel="cc:attributionURL">
    Centrum Edukacji Obywatelskiej</a> na licencji <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
    Creative Commons Uznanie autorstwa-Na tych samych warunkach 4.0 Międzynarodowa</a>.<br />
</p>

<script>
  // dla http://koduj-z-klasa.github.io/python101/
  // w read the docs kod uzupełnia się w dashboardzie
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55172998-1', 'auto');
  ga('send', 'pageview');
</script></div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tictactoe/index.html" class="btn btn-neutral float-right" title="11. Gra w Kółko i Krzyżyk (obj)"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../pong/index.html" class="btn btn-neutral" title="9. Gra w Ponga (obj)"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; <a href="../copyright.html">Copyright</a> 2014, Centrum Edukacji Obywatelskiej.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>